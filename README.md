# Tracker33 - Система отслеживания времени и активности

Tracker33 - это полноценная система мониторинга рабочего времени и активности пользователя, состоящая из клиентского десктопного приложения и серверной части.

## Возможности

- Отслеживание активности приложений и затраченного времени
- Мониторинг клавиатурной активности
- Классификация приложений на продуктивные и непродуктивные
- Веб-интерфейс для просмотра статистики и логов
- Авторизация и безопасность данных пользователей

## Структура системы

- **Серверная часть**: Django приложение для хранения и обработки данных
- **Клиентское приложение**: Десктопное приложение на PyQt для отслеживания активности пользователя
- **Веб-интерфейс**: Интерфейс для просмотра статистики и логов

## Требования

### Общие требования
- Python 3.8+
- pip (менеджер пакетов Python)
- Git (для клонирования репозитория)

### Требования для серверной части
- Django 3.2+
- Django REST framework
- PostgreSQL (рекомендуется) или SQLite (по умолчанию)

### Требования для клиентского приложения
- PyQt5
- pynput
- psutil
- requests

## Установка и настройка серверной части

### 1. Клонирование репозитория

```bash
git clone https://github.com/your-username/Tracker33.git
cd Tracker33
```

### 2. Создание виртуального окружения и установка зависимостей

```bash
python -m venv venv
# Активация в Windows
venv\Scripts\activate
# Активация в Linux/Mac
source venv/bin/activate

# Установка зависимостей
pip install -r requirements.txt
```

### 3. Настройка базы данных

По умолчанию проект использует SQLite, что достаточно для тестирования и небольшого использования. Для продакшн-среды рекомендуется PostgreSQL.

#### Настройка PostgreSQL (опционально, но рекомендуется для продакшн)

1. Установите PostgreSQL с официального сайта: https://www.postgresql.org/download/
2. Создайте базу данных и пользователя:

```sql
CREATE DATABASE tracker33;
CREATE USER tracker33_user WITH PASSWORD 'ваш_пароль';
ALTER ROLE tracker33_user SET client_encoding TO 'utf8';
ALTER ROLE tracker33_user SET default_transaction_isolation TO 'read committed';
ALTER ROLE tracker33_user SET timezone TO 'UTC';
GRANT ALL PRIVILEGES ON DATABASE tracker33 TO tracker33_user;
```

3. Измените настройки базы данных в файле `Tracker33/settings.py`:

```python
DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.postgresql',
        'NAME': 'tracker33',
        'USER': 'tracker33_user',
        'PASSWORD': 'ваш_пароль',
        'HOST': 'localhost',
        'PORT': '5432',
    }
}
```

### 4. Миграция базы данных

```bash
python manage.py migrate
```

### 5. Создание суперпользователя

```bash
python manage.py createsuperuser
```

### 6. Сбор статических файлов

```bash
python manage.py collectstatic
```

### 7. Запуск сервера в режиме разработки

```bash
python manage.py runserver
```

Сервер будет доступен по адресу: http://127.0.0.1:8000/

### 8. Настройка для продакшн (Nginx + Gunicorn)

Для использования в продакшн-среде рекомендуется использовать Nginx в качестве прокси и Gunicorn как WSGI-сервер.

#### Установка Gunicorn

```bash
pip install gunicorn
```

#### Создание systemd службы (Linux)

Создайте файл `/etc/systemd/system/tracker33.service`:

```ini
[Unit]
Description=Tracker33 Gunicorn Daemon
After=network.target

[Service]
User=yourusername
Group=yourgroup
WorkingDirectory=/path/to/Tracker33
ExecStart=/path/to/Tracker33/venv/bin/gunicorn --workers 3 --bind 127.0.0.1:8000 Tracker33.wsgi:application
Restart=on-failure

[Install]
WantedBy=multi-user.target
```

Активируйте и запустите сервис:

```bash
sudo systemctl enable tracker33
sudo systemctl start tracker33
```

#### Настройка Nginx

Установите Nginx:

```bash
sudo apt-get install nginx  # для Ubuntu/Debian
```

Создайте файл конфигурации `/etc/nginx/sites-available/tracker33`:

```nginx
server {
    listen 80;
    server_name your_domain.com;
    
    location = /favicon.ico { access_log off; log_not_found off; }
    
    location /static/ {
        root /path/to/Tracker33;
    }
    
    location / {
        proxy_pass http://127.0.0.1:8000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
}
```

Активируйте конфигурацию:

```bash
sudo ln -s /etc/nginx/sites-available/tracker33 /etc/nginx/sites-enabled/
sudo nginx -t  # Проверка конфигурации
sudo systemctl restart nginx
```

### 9. Настройка HTTPS (Рекомендуется для продакшн)

Для настройки HTTPS рекомендуется использовать Let's Encrypt:

```bash
sudo apt-get install certbot python3-certbot-nginx
sudo certbot --nginx -d your_domain.com
```

## Установка и запуск клиентского приложения

### 1. Перейдите в директорию клиентского приложения

```bash
cd desktop_app
```

### 2. Установите необходимые зависимости

```bash
pip install -r requirements.txt
```

### 3. Настройка конфигурации

Откройте файл `config.ini` и настройте параметры:

```ini
[Server]
api_url = http://127.0.0.1:8000/api/
server_url = http://127.0.0.1:8000/
username = your_username
password = your_password

[Settings]
tracking_interval = 5
send_interval = 30
```

### 4. Запуск приложения

```bash
python main.py
```

### 5. Создание исполняемого файла (опционально)

Для создания исполняемого файла используйте PyInstaller:

```bash
pip install pyinstaller
pyinstaller --onefile --windowed --icon=icon.ico main.py
```

Исполняемый файл будет создан в папке `dist`.

## Использование системы

### Веб-интерфейс

1. **Вход в систему**:
   - Перейдите по адресу http://127.0.0.1:8000/ (или вашему домену в продакшн)
   - Введите логин и пароль, созданные при выполнении команды `createsuperuser`

2. **Главная панель (Dashboard)**:
   - Общая статистика активности за сегодня
   - Графики использования приложений
   - Краткая сводка продуктивности

3. **Страница статистики** (http://127.0.0.1:8000/statistics/):
   - Подробная статистика по использованию приложений
   - Время, проведенное в продуктивных и непродуктивных приложениях
   - Клавиатурная активность

4. **Страница логов** (http://127.0.0.1:8000/logs/):
   - История активности пользователя
   - Журнал клавиатурной активности
   - Фильтрация по дате и приложениям

### Клиентское приложение

1. **Авторизация**:
   - При первом запуске введите свои учетные данные
   - Приложение сохранит токен для последующих запусков

2. **Отслеживание активности**:
   - Приложение автоматически начнет отслеживать активность после запуска
   - Система отслеживает активные окна и время, проведенное в каждом приложении
   - Клавиатурная активность фиксируется и отправляется на сервер

3. **Настройка отслеживаемых приложений**:
   - Нажмите "Настройки" в главном окне
   - Отметьте приложения для отслеживания
   - Укажите, является ли приложение продуктивным или нет

4. **Системный трей**:
   - Приложение можно свернуть в системный трей
   - Правый клик по иконке в трее предоставляет доступ к основным функциям

5. **Паузирование отслеживания**:
   - Для временной остановки отслеживания нажмите кнопку "Пауза"
   - Для возобновления отслеживания нажмите "Продолжить"

## Устранение неполадок

### Проблемы с сервером

1. **Сервер не запускается**:
   - Проверьте логи в файле `logs/debug.log`
   - Убедитесь, что порт 8000 не занят другим приложением
   - Проверьте права доступа к директории проекта

2. **Ошибки базы данных**:
   - Проверьте настройки подключения к базе данных в `settings.py`
   - Убедитесь, что сервер базы данных запущен
   - Выполните команду `python manage.py migrate` еще раз

3. **Нет доступа к веб-интерфейсу**:
   - Проверьте настройки брандмауэра
   - Проверьте, запущен ли сервер (`python manage.py runserver`)
   - В продакшн-среде проверьте настройки Nginx и Gunicorn

### Проблемы с клиентским приложением

1. **Приложение не запускается**:
   - Проверьте установлены ли все зависимости
   - Проверьте логи в папке `logs`
   - Проверьте наличие файла `config.ini` и корректность настроек

2. **Ошибки соединения с сервером**:
   - Убедитесь, что сервер запущен и доступен
   - Проверьте правильность URL в конфигурационном файле
   - Проверьте наличие интернет-соединения

3. **Не работает отслеживание активности**:
   - Проверьте, не заблокировано ли приложение антивирусом или брандмауэром
   - Перезапустите приложение с правами администратора
   - Проверьте системный журнал на наличие ошибок

## Безопасность данных

- Все соединения с сервером рекомендуется защищать с помощью HTTPS
- Учетные данные пользователей хранятся в зашифрованном виде
- Для продакшн-среды рекомендуется настроить регулярное резервное копирование базы данных
- Рекомендуется регулярно обновлять Django и другие зависимости

## Поддержка и обновления

Для получения помощи или сообщения о проблемах:
- Создайте issue в GitHub репозитории
- Свяжитесь с разработчиками по электронной почте

---

© 2023 Tracker33. Все права защищены. 